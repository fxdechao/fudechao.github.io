<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[ansible脚本]]></title>
      <url>http://yoursite.com/2016/07/29/ansible%E8%84%9A%E6%9C%AC/</url>
      <content type="html"><![CDATA[<blockquote>
<p>这是一个可以自动在多台server批量安装及拷贝配置文件启动服务器的ansible脚本，本人学疏才浅，目前还有很多待完善，希望各位多多指教。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># Author: Altamob </div><div class="line"># Directory tree</div><div class="line"># 	/opt/			</div><div class="line"># 	├── ansible.sh	# like this,nginx.conf is varia $FILE</div><div class="line"># 	└── nginx.conf</div><div class="line"></div><div class="line"># Host IP One</div><div class="line">HOST=172.18.4.62</div><div class="line"># Host IP two</div><div class="line">HOST1=</div><div class="line"># conf file template</div><div class="line">FILE=nginx.conf</div><div class="line"></div><div class="line">cat &lt;&lt; EOF</div><div class="line">+---------------------------------------+</div><div class="line">|   this is a ansible script           |</div><div class="line">|      from Altamob.......          |</div><div class="line">+---------------------------------------</div><div class="line">EOF</div><div class="line"></div><div class="line">read -p &quot;pelease input your service name: &quot; SER</div><div class="line">read -p &quot;pelease input your hostgroup name: &quot; HOSTGROUP</div><div class="line"></div><div class="line"></div><div class="line">mkdir /etc/ansible/roles/$&#123;SER&#125;/&#123;tasks,templates,vars,handlers&#125; -pv &amp;&gt;/dev/null</div><div class="line"></div><div class="line">cp $FILE /etc/ansible/roles/$&#123;SER&#125;/templates/$&#123;FILE&#125;.j2 &amp;&gt;/dev/null</div><div class="line">cat &gt;&gt; /etc/ansible/hosts &lt;&lt; EOF</div><div class="line">[$HOSTGROUP]</div><div class="line">$HOST</div><div class="line">$HOST1</div><div class="line">EOF</div><div class="line">cat &gt; /etc/ansible/roles/$SER/tasks/main.yml &lt;&lt; EOF</div><div class="line">- name: install $SER</div><div class="line">  yum: name=$SER state=present</div><div class="line">- name: copy conf file</div><div class="line">  template: src=$&#123;FILE&#125;.j2 dest=/etc/$&#123;SER&#125;/$&#123;FILE&#125;</div><div class="line">  notify: restart</div><div class="line">  tags: conf</div><div class="line">- name: start service</div><div class="line">  service: name=nginx state=started </div><div class="line">EOF</div><div class="line">#cat &gt; /etc/ansible/roles/$SER/tasks/main.yml &lt;&lt; EOF</div><div class="line">#- name: install $SER</div><div class="line">#  yum: name=$SER state=present</div><div class="line">#- name: copy conf file</div><div class="line">#  template: src=$&#123;FILE&#125;.j2 dest=/etc/$&#123;SER&#125;/$&#123;FILE&#125;</div><div class="line">#  notify: restart</div><div class="line">#  tags: conf</div><div class="line">#- name: start service</div><div class="line">#  service: name=nginx state=started </div><div class="line">#EOF</div><div class="line">cat &gt; /etc/ansible/roles/$&#123;SER&#125;/handlers/main.yml &lt;&lt;EOF</div><div class="line">- name: restart</div><div class="line">  service: name=$&#123;SER&#125; state=restarted</div><div class="line">EOF</div><div class="line"></div><div class="line">cat &gt;&gt; /etc/ansible/ansible.cfg &lt;&lt;EOF</div><div class="line">host_key_checking = False</div><div class="line">EOF</div><div class="line">cat &gt;&gt; /opt/$&#123;SER&#125;.yaml &lt;&lt;EOF</div><div class="line">- hosts: $&#123;HOSTGROUP&#125;</div><div class="line">  remote_user: root</div><div class="line">  roles:</div><div class="line">  - $&#123;SER&#125;</div><div class="line">EOF</div><div class="line"></div><div class="line">cd /opt/;ansible-playbook $&#123;SER&#125;.yaml</div></pre></td></tr></table></figure>
<blockquote>
<p>作者：<code>Antony</code> WX&amp;QQ：<code>1257465991</code><br>Q/A：如有问题请慷慨提出</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Linux用户、用户组及权限管理]]></title>
      <url>http://yoursite.com/2016/07/28/Linux%E7%94%A8%E6%88%B7%E3%80%81%E7%94%A8%E6%88%B7%E7%BB%84%E5%8F%8A%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/</url>
      <content type="html"><![CDATA[<h3 id="一、Linux用户及用户组的基本概念"><a href="#一、Linux用户及用户组的基本概念" class="headerlink" title="一、Linux用户及用户组的基本概念"></a>一、Linux用户及用户组的基本概念</h3><p>用户：用户是实现能够将有限的资源在多个使用者之间进行分配；、<br>用户组：用户组是指多个用户的集合，方便对一类需要同样权限的用户授权<br>Linux是多用户、多任务的操作系统。<br>    多用户指：多人同时使用系统资源；多任务：同时运行多个进程</p>
<h3 id="二、用户及用户组类别"><a href="#二、用户及用户组类别" class="headerlink" title="二、用户及用户组类别"></a>二、用户及用户组类别</h3><h4 id="1、用户：名称解析库-etc-passwd"><a href="#1、用户：名称解析库-etc-passwd" class="headerlink" title="1、用户：名称解析库 /etc/passwd"></a>1、用户：名称解析库 /etc/passwd</h4><p>a、管理员<br>root 用户标识（UID）为0<br>b、普通用户及系统用户<br>    普通用户的用户标识（既UID）：<br>        CentOS 5,6: 500+<br>        CentOS 7: 1000+<br>    系统用户用户标识（既UID）：<br>        CentOS 5,6: 1-499<br>        CentOS 7: 1-999</p>
<h4 id="2、用户组：名称解析库-etc-group"><a href="#2、用户组：名称解析库-etc-group" class="headerlink" title="2、用户组：名称解析库 /etc/group"></a>2、用户组：名称解析库 /etc/group</h4><p>a、管理员组<br>组标识为：0<br>b、普通用户组及系统用户组<br>    普通用户组标识：<br>        CentOS 5,6: 500+<br>        CentOS 7: 1000+<br>    系统用户组标识：<br>        CentOS 5,6: 1-499<br>        CentOS 7: 1-999<br>3、用户组类别：<br>    以用户为核心分为：<br>        用户的主组：基本组；<br>        用户的附加组：额外组；<br>    以容纳的用户来划分：<br>        私有组：与用户名相同，且只有一个用户；<br>        共有组：组内包含了多个用户；</p>
<h3 id="三、用户及用户组的认证机制"><a href="#三、用户及用户组的认证机制" class="headerlink" title="三、用户及用户组的认证机制"></a>三、用户及用户组的认证机制</h3><p>Linux的用户密码认证方式在centos7中使用sha512<br>认证信息库存储位置：<br>    用户的认证信息库：/etc/shadow<br>    组的认证信息库：/etc/gshadow<br>密码：加密存放，使用单向加密机制<br>算法：<br>md5: message digest, 128bits<br>sha1: secure hash algorithm, 160bits<br>sha224<br>sha256<br>sha384<br>sha512</p>
<h3 id="四、权限的生效机制"><a href="#四、权限的生效机制" class="headerlink" title="四、权限的生效机制"></a>四、权限的生效机制</h3><p>进程的运行者：<br>    是否与文件的属主相同，如果是，则以文件属主的身份来访问此文件；否则<br>    是否属于文件的属组，如果是，则以文件属组的身份来访问此文件；否则<br>    以文件的其它用户的身份来访问此文件；<br><img src="http://zantony.top/uploads/quanxian.png" alt="enter image description here"></p>
<h3 id="五、用户及用户组管理命令"><a href="#五、用户及用户组管理命令" class="headerlink" title="五、用户及用户组管理命令"></a>五、用户及用户组管理命令</h3><h4 id="groupadd命令：添加组"><a href="#groupadd命令：添加组" class="headerlink" title="groupadd命令：添加组"></a>groupadd命令：添加组</h4><p>groupadd [options] group<br>-g  GID：指明GID；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># groupadd -g 2000 testgrp</div><div class="line"># grep &quot;testgrp&quot; /etc/group</div><div class="line">testgrp:x:2000:</div><div class="line">    -r, --system：系统组；</div><div class="line"># groupadd -r testgrp1</div><div class="line"># grep &quot;testgrp1&quot; /etc/group</div><div class="line">testgrp1:x:985:</div></pre></td></tr></table></figure></p>
<h4 id="groupmod命令：修改组信息"><a href="#groupmod命令：修改组信息" class="headerlink" title="groupmod命令：修改组信息"></a>groupmod命令：修改组信息</h4><p>groupmod [选项] GROUP<br>-g  GID<br>-n NEW_NAME：修改组名；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># grep &quot;testgrp\&gt;&quot; /etc/group</div><div class="line">testgrp:x:2000:</div><div class="line"># groupmod -g 300 -n grptest testgrp</div><div class="line"># grep &quot;grptest&quot; /etc/group</div><div class="line">grptest:x:300:</div></pre></td></tr></table></figure></p>
<h4 id="groupdel命令：删除组"><a href="#groupdel命令：删除组" class="headerlink" title="groupdel命令：删除组"></a>groupdel命令：删除组</h4><p>groupdel [选项] GROUP<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># grep &quot;grptest&quot; /etc/group</div><div class="line">grptest:x:300:</div><div class="line"># groupdel grptest</div><div class="line"># grep &quot;grptest&quot; /etc/group</div></pre></td></tr></table></figure></p>
<h4 id="useradd命令：添加用户"><a href="#useradd命令：添加用户" class="headerlink" title="useradd命令：添加用户"></a>useradd命令：添加用户</h4><blockquote>
<p>useradd  [选项]  登录名<br>-c, –comment COMMENT：注释信息，一般为Full Name；<br>-d, –home  /PATH/TO/HOME_DIR：家目录路径；目标路径不能事先存在，否则会有警告，不会复制skel相关的文件给用户；<br>-g, –gid GROUP：用户的基本组组名或GID；<br>-G, –groups GROUP1[,GROUP2,…[,GROUPN]]]：用户所属的附加组列表，彼此间用逗号隔开，中间没有空格；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"># useradd -c &quot;testuser&quot; -d /home/testuser -g testgrp -G testgrp1 testuser</div><div class="line"># id testuser</div><div class="line">uid=5011(testuser) gid=5011(testgrp) groups=5011(testgrp),985(testgrp1）</div><div class="line">    -m, --create-home：强制创建家目录；</div><div class="line">            一般指当CREATE_HOME变量为设置时必须使用此参数 </div><div class="line">    -M：不创建用户主目录，即使系统在 /etc/login.defs 中的设置 (CREATE_HOME) 为 yes；   </div><div class="line"># useradd -M testuser2</div><div class="line"># ls /home/</div><div class="line">centos  gentoo   nologin    test1  test3</div><div class="line">fedora  mageedu  slackware  test2  testuser</div><div class="line">        -r, --system：创建一个系统账户</div><div class="line">    创建系统用的UID在0-999之内。且不创建家目录</div><div class="line"># useradd -r testuser3</div><div class="line"># id testuser3</div><div class="line">uid=990(testuser3) gid=984(testuser3) groups=984(testuser3)</div><div class="line"># ls /home/</div><div class="line">centos  gentoo   nologin    test1  test3</div><div class="line">fedora  mageedu  slackware  test2  testuser</div><div class="line">    -s, --shell SHELL：用户的登录 shell 名，默认为留空，让系统根据 /etc/default/useradd 中的 SHELL 变量选择默认的登录shell；</div><div class="line">    -u, --uid UID：用户 ID 的数字值。此值必须为唯一的，除非使用了 -o 选项。此值必须非负，默认使用大于等于UID_MIN，且大于任何其他用户 ID 最小值。</div></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"># cat /etc/shells </div><div class="line">/bin/sh</div><div class="line">/bin/bash</div><div class="line">/sbin/nologin</div><div class="line">/usr/bin/sh</div><div class="line">/usr/bin/bash</div><div class="line">/usr/sbin/nologin</div><div class="line">/bin/tcsh</div><div class="line">/bin/csh</div><div class="line"># useradd -s /bin/bash -u 3001 testuser4</div><div class="line"># grep &quot;testuser4\&gt;&quot; /etc/passwd</div><div class="line">testuser4:x:3001:3001::/home/testuser4:/bin/bash</div><div class="line">注意：创建登录用户时，为其自定义的shell程序必须为可登录shell，且要位于/etc/shells文件中；</div><div class="line">        useradd -D：显示创建用户时的默认设置；</div><div class="line">useradd -D  选项：设置某默认选项；</div><div class="line">    -e, --expiredate  EXPIRE_DATE：用户账号的过期期限；过期后会被锁定；日期以 YYYY-MM-DD 格式指定</div><div class="line">    -f, --inactive INACTIVE：密码过期后，账户被彻底禁用之前的天数。0 表示立即禁用，-1 表示禁用这个功能。</div><div class="line"># useradd -D</div><div class="line">GROUP=100</div><div class="line">HOME=/home</div><div class="line">INACTIVE=-1</div><div class="line">EXPIRE=</div><div class="line">SHELL=/bin/bash</div><div class="line">SKEL=/etc/skel</div><div class="line">CREATE_MAIL_SPOOL=yes</div><div class="line"># useradd -e 2020-03-08 testuser5</div><div class="line"># useradd -f 3 testuser6</div><div class="line">    为用户提供默认配置的配置文件：</div><div class="line">/etc/login.defs, /etc/default/useradd</div><div class="line">影子口令文件：/etc/shadow</div><div class="line">/etc/shadow每个字段的意思：</div><div class="line">            登录名:密码:最近一次的修改时间:密码的最短使用期限:密码最长使用期限:提前警告的天数:非活动期限:账号的禁用日期:保留字段</div></pre></td></tr></table></figure>
<h4 id="usermod命令：修改账号信息"><a href="#usermod命令：修改账号信息" class="headerlink" title="usermod命令：修改账号信息"></a>usermod命令：修改账号信息</h4><blockquote>
<p>-c, –comment  COMMENT<br>-d, –home  HOME_DIR：修改家目录为新的位置，但一般应该同时使用-m选项以保证原家目录中的文件会移动到新目录中；<br>-g, –gid GROUP<br>-G, –groups  GRO    UP1[,GROUP2,…[,GROUPN]]]：修改时会覆盖原有的附加组；一同使用-a选项，表示为用户添加新的附加组；<br>-l, –login  NEW_LOGIN：修改当前用户的用户名；<br>-s, –shell  SHELL<br>-u, –uid  UID<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"># grep &quot;mageedu&quot; /etc/passwd</div><div class="line">mageedu:x:5015:5015:mageedu:/home/mageedu:/bin/bash</div><div class="line"># usermod -c &quot;this is mageedu&quot; -m -d /opt/mageedu -g 5000 -G 6000 -l mageedugood -u 3000 mageedu</div><div class="line"># grep &quot;mageedu&quot; /etc/passwd</div><div class="line">mageedugood:x:3000:5000:this is mageedu:/opt/mageedu:/bin/bash</div><div class="line"># id mageedugood</div><div class="line">uid=3000(mageedugood) gid=5000(mage) groups=5000(mage),6000(xueba)</div><div class="line">    -L, --lock：锁定用户的密码。这会在用户加密的密码之前放置一个“!”</div><div class="line">    -U, --unlock：解锁用户的密码。这将移除加密的密码之前的“!”</div><div class="line"># grep &quot;mageedu&quot; /etc/shadow</div><div class="line">mageedugood:$6$MKpxQ.kL$o6IBhP9uXHlccwXLUubV.Xp.k4KVJ5mTEtPtDeyoz4O38FRq1wuiyH1vyYlHEy9uqRt7a1Mzzf0bCnCKrtxHL/:16868:0:99999:7:::</div><div class="line"># usermod -L mageedugood</div><div class="line"># grep &quot;mageedu&quot; /etc/shadow   #此处可以看到锁定后在密码前面有一个!号</div><div class="line">mageedugood:!$6$MKpxQ.kL$o6IBhP9uXHlccwXLUubV.Xp.k4KVJ5mTEtPtDeyoz4O38FRq1wuiyH1vyYlHEy9uqRt7a1Mzzf0bCnCKrtxHL/:16868:0:99999:7:::</div><div class="line"># usermod -U mageedugood</div><div class="line"># grep &quot;mageedu&quot; /etc/shadow</div><div class="line">mageedugood:$6$MKpxQ.kL$o6IBhP9uXHlccwXLUubV.Xp.k4KVJ5mTEtPtDeyoz4O38FRq1wuiyH1vyYlHEy9uqRt7a1Mzzf0bCnCKrtxHL/:16868:0:99999:7:::</div></pre></td></tr></table></figure></p>
</blockquote>
<h4 id="userdel命令：删除用户账号"><a href="#userdel命令：删除用户账号" class="headerlink" title="userdel命令：删除用户账号"></a>userdel命令：删除用户账号</h4><p>userdel [选项]  登录名<br>-r, –remove：用户主目录中的文件将随用户主目录和用户邮箱一起删除<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># userdel -r mageedugood</div><div class="line"># id mageedugood</div><div class="line">id: mageedugood: no such user</div><div class="line"># ls /home/  #加上-r选项后同时删除用户的家目录以及用户邮箱</div><div class="line">centos  gentoo   slackware  test2  testuser   testuser5</div><div class="line">fedora  nologin  test1      test3  testuser4  testuser6</div><div class="line"># userdel test1</div><div class="line"># ls /home/   #未加-r可以找到test1用户的家目录</div><div class="line">centos  gentoo   slackware  test2  testuser   testuser5</div><div class="line">fedora  nologin  test1      test3  testuser4  testuser6</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># id test1</div><div class="line">id: test1: no such user</div></pre></td></tr></table></figure>
<h4 id="passwd命令：密码管理命令"><a href="#passwd命令：密码管理命令" class="headerlink" title="passwd命令：密码管理命令"></a>passwd命令：密码管理命令</h4><p>(1) passwd：修改自己的密码；<br>(2) passwd  username：修改其它用户的密码，仅root有此权限；<br>密码复杂度：<br>        (1) 不能少于8个字符；<br>        (2) 不能使用与过去的密码太相似的密码；<br>        (3) 应该使用四类字符中的至少三类；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"># passwd test2</div><div class="line">Changing password for user test2.</div><div class="line">New password: </div><div class="line">BAD PASSWORD: The password is shorter than 8 characters</div><div class="line">Retype new password: </div><div class="line">passwd: all authentication tokens updated successfully.</div><div class="line">选项：</div><div class="line">	    -l：锁定密码</div><div class="line">	    -u：解锁解密</div><div class="line">	    -d：清除密码</div><div class="line"># grep &quot;test2&quot; /etc/shadow</div><div class="line">test2:$6$9E3j7rHK$XBRQVO0SVqivKXi7gHTadSjAkjpZz72YsGa60xHK.uUQlnHhsD8w4ttT466ADR9AuXz8KrBWhxRfnGHeFGXiZ/:16868:0:99999:7:::</div><div class="line"># passwd -l test2</div><div class="line">Locking password for user test2.</div><div class="line">passwd: Success</div><div class="line"># grep &quot;test2&quot; /etc/shadow</div><div class="line">test2:!!$6$9E3j7rHK$XBRQVO0SVqivKXi7gHTadSjAkjpZz72YsGa60xHK.uUQlnHhsD8w4ttT466ADR9AuXz8KrBWhxRfnGHeFGXiZ/:16868:0:99999:7:::</div><div class="line"># passwd -u test2</div><div class="line">Unlocking password for user test2.</div><div class="line">passwd: Success</div><div class="line"># grep &quot;test2&quot; /etc/shadow</div><div class="line">test2:$6$9E3j7rHK$XBRQVO0SVqivKXi7gHTadSjAkjpZz72YsGa60xHK.uUQlnHhsD8w4ttT466ADR9AuXz8KrBWhxRfnGHeFGXiZ/:16868:0:99999:7:::</div><div class="line"># passwd -d test2</div><div class="line">Removing password for user test2.</div><div class="line">passwd: Success</div><div class="line"># grep &quot;test2&quot; /etc/shadow</div><div class="line">test2::16868:0:99999:7:::</div><div class="line">    与usermod不同的是，passwd在锁定时密码前面有两个!!号</div></pre></td></tr></table></figure></p>
<h4 id="特殊用法：可以避免交互式"><a href="#特殊用法：可以避免交互式" class="headerlink" title="特殊用法：可以避免交互式"></a>特殊用法：可以避免交互式</h4><p>–stdin：从标准输入接收密码；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">echo &quot;PASSWORD&quot; | passwd  --stdin  USERNAME</div><div class="line"># echo &quot;mageedu&quot;|passwd --stdin test2</div><div class="line">Changing password for user test2.</div><div class="line">passwd: all authentication tokens updated successfully.</div></pre></td></tr></table></figure></p>
<h4 id="gpasswd命令：为组添加密码"><a href="#gpasswd命令：为组添加密码" class="headerlink" title="gpasswd命令：为组添加密码"></a>gpasswd命令：为组添加密码</h4><p>组密码文件：/etc/gshadow<br>gpasswd [选项] group<br>-a USERNAME：把用户添加至组中；<br>-d USERNAME：从此组中移除此用户；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># gpasswd -a test3 xueba</div><div class="line">Adding user test3 to group xueba</div><div class="line"># grep &quot;xueba&quot; /etc/gshadow</div><div class="line">xueba:$6$bxtP5/lZt$umET9D6NeQrdWDGNG0LfpUQiJ5Poq8Xa0GoaDQqJFvqLVm3GWrCxOtDnCXbGjZngS4S7lumQE9hW18DgWPBrm.::test2,test3</div><div class="line"># gpasswd -d test2 xueba</div><div class="line">Removing user test2 from group xueba</div><div class="line"># grep &quot;xueba&quot; /etc/gshadow</div><div class="line">xueba:$6$bxtP5/lZt$umET9D6NeQrdWDGNG0LfpUQiJ5Poq8Xa0GoaDQqJFvqLVm3GWrCxOtDnCXbGjZngS4S7lumQE9hW18DgWPBrm.::test3</div></pre></td></tr></table></figure></p>
<h4 id="newgrp命令：登录到一个新组"><a href="#newgrp命令：登录到一个新组" class="headerlink" title="newgrp命令：登录到一个新组"></a>newgrp命令：登录到一个新组</h4><h4 id="chage命令：修改用户账号的各种期限；"><a href="#chage命令：修改用户账号的各种期限；" class="headerlink" title="chage命令：修改用户账号的各种期限；"></a>chage命令：修改用户账号的各种期限；</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ touch testfile</div><div class="line">$ ll testfile </div><div class="line">-rw-rw-r-- 1 test2 test2 0 Mar  8 12:43 testfile</div><div class="line">$ newgrp xueba</div><div class="line">$ touch testfile2</div><div class="line">$ ll testfile2 </div><div class="line">-rw-r--r-- 1 test2 xueba 0 Mar  8 12:44 testfile2</div></pre></td></tr></table></figure>
<h3 id="五、文件系统权限简介"><a href="#五、文件系统权限简介" class="headerlink" title="五、文件系统权限简介"></a>五、文件系统权限简介</h3><h4 id="文件系统文件权限："><a href="#文件系统文件权限：" class="headerlink" title="文件系统文件权限："></a>文件系统文件权限：</h4><blockquote>
<p>三类用户：<br>属主：owner, u<br>属组：group, g<br>其它：other, o<br>所有：All，a<br>权限：<br>r: readable，可读<br>w: writable, 可写<br>x：excutable, 可执行<br>权限管理：<br>文件：<br>r：可获取文件的数据；<br>w：可修改文件的数据；<br>x：可将此文件运行为进程；<br>目录：<br>r：可使用ls命令获取其下的所有文件列表；但不可以使用“ls -l”去获取详细信息，也不可以cd至此目录中；<br>w：可修改此目录下的文件列表， 即可以在此目录下创建或删除文件；<br>x：可以使用”ls -l“命令来获取其下的文件的详细属性信息，也可cd至此目录中；</p>
</blockquote>
<h3 id="六、文件系统权限管理命令"><a href="#六、文件系统权限管理命令" class="headerlink" title="六、文件系统权限管理命令"></a>六、文件系统权限管理命令</h3><h4 id="chmod命令："><a href="#chmod命令：" class="headerlink" title="chmod命令："></a>chmod命令：</h4><blockquote>
<p>作用：change file mode bits<br>        使用方式：<br>    chmod [OPTION]… MODE[,MODE]… FILE…</p>
<pre><code>    # 以ugoa的方式来进行授权
chmod [OPTION]... OCTAL-MODE FILE...
    # 权限数字是数值模式：是从一到四的八进制数字（0-7），分别用4（读权限） 2（写权限）             1（可执行权限） 
chmod [OPTION]... --reference=RFILE FILE...
    # 标识权限参照某文件修改
</code></pre><h5 id="1-chmod-OPTION-…-MODE-MODE-…-FILE…"><a href="#1-chmod-OPTION-…-MODE-MODE-…-FILE…" class="headerlink" title="(1) chmod [OPTION]… MODE[,MODE]… FILE…"></a>(1) chmod [OPTION]… MODE[,MODE]… FILE…</h5><p>MODE：<br>    赋权表示法：直接操作一类用户的所有权限位rwx；<br>            u=<br>            g=<br>            o=<br>            a=<br>            两类用户权限相同：ug=, go=<br>            不同类的用户权限不同：u=,g=,o=<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rw-r--r-- 1 root root 595 Mar  8 15:57 fstab</div><div class="line"># chmod u=r,g=w,o=x fstab </div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-r---w---x 1 root root 595 Mar  8 15:57 fstab</div><div class="line"></div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-r---w---x 1 root root 595 Mar  8 15:57 fstab</div><div class="line"># chmod a=rw fstab </div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rw-rw-rw- 1 root root 595 Mar  8 15:57 fstab</div><div class="line">    授权表示法：操作一类用户一位或多位权限；</div><div class="line">	        u+, u-</div><div class="line">	        g+, g-</div><div class="line">	        o+, o-</div><div class="line">	        a+, a-</div><div class="line">	        两类用户权限收授机制相同：ug+, ug-, ...</div><div class="line">	        不同类的用户权限不同：u+,g+,o+</div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rw-rw-rw- 1 root root 595 Mar  8 15:57 fstab</div><div class="line"># chmod u+x,g-w,o-r fstab </div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rwxr---w- 1 root root 595 Mar  8 15:57 fstab</div><div class="line"></div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rwxr-xr-x 1 root root 595 Mar  8 15:57 fstab</div><div class="line"># chmod ug-x,o+w fstab </div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rw-r--rwx 1 root root 595 Mar  8 15:57 fstab</div><div class="line"></div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-r--r--r-x 1 root root 595 Mar  8 15:57 fstab</div><div class="line"># chmod a+w fstab </div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rw-rw-rwx 1 root root 595 Mar  8 15:57 fstab</div></pre></td></tr></table></figure></p>
</blockquote>
<h5 id="2-chmod-OPTION-…-OCTAL-MODE-FILE…"><a href="#2-chmod-OPTION-…-OCTAL-MODE-FILE…" class="headerlink" title="(2) chmod [OPTION]… OCTAL-MODE FILE…"></a>(2) chmod [OPTION]… OCTAL-MODE FILE…</h5><blockquote>
<p>OCTAL-MODE：权限标识<br>r：4<br>w：2<br>x：1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"># chmod 755 fstab </div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rwxr-xr-x 1 root root 595 Mar  8 15:57 fstab</div><div class="line"></div><div class="line"># chmod 600 fstab </div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rw------- 1 root root 595 Mar  8 15:57 fstab</div><div class="line"></div><div class="line"># chmod 644 fstab </div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rw-r--r-- 1 root root 595 Mar  8 15:57 fstab</div><div class="line">注意：使用数字标识权限时不可省略，例如：</div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rw-r--r-- 1 root root 595 Mar  8 15:57 fstab</div><div class="line"># chmod 60 fstab </div><div class="line"># ll</div><div class="line">total 4</div><div class="line">----rw---- 1 root root 595 Mar  8 15:57 fstab</div><div class="line">这里本来要改文件的属主为6（rw），文件的属组没有权限，但是更改后就变成属组为6，而属主与其他用户没有权限</div></pre></td></tr></table></figure></p>
</blockquote>
<h5 id="3-chmod-OPTION-…-–reference-RFILE-FILE…"><a href="#3-chmod-OPTION-…-–reference-RFILE-FILE…" class="headerlink" title="(3) chmod [OPTION]… –reference=RFILE FILE…"></a>(3) chmod [OPTION]… –reference=RFILE FILE…</h5><blockquote>
<p>常用选项：<br>-R, –recursive：递归修改；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"># ll mode/</div><div class="line">total 4</div><div class="line">-rw-r--r-- 1 root root 595 Mar  8 16:13 fstab</div><div class="line"># ll mode/ -d</div><div class="line">drwxr-xr-x 2 root root 18 Mar  8 16:13 mode/</div><div class="line"># chmod -R o+w mode/</div><div class="line"># ll mode/ -d</div><div class="line">drwxr-xrwx 2 root root 18 Mar  8 16:13 mode/</div><div class="line"># ll mode/</div><div class="line">total 4</div><div class="line">-rw-r--rw- 1 root root 595 Mar  8 16:13 fstab</div><div class="line">            --reference=RFILE：RFILE表示参考其权限模型；</div><div class="line"># ll</div><div class="line">total 4</div><div class="line">----rw---- 1 root root 595 Mar  8 15:57 fstab</div><div class="line"># ll /etc/fstab </div><div class="line">-rw-r--r--. 1 root root 595 Mar 12  2016 /etc/fstab</div><div class="line"># chmod --reference=/etc/fstab /tmp/fstab </div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rw-r--r-- 1 root root 595 Mar  8 15:57 fstab</div></pre></td></tr></table></figure></p>
</blockquote>
<h6 id="chown命令：修改属主或属组"><a href="#chown命令：修改属主或属组" class="headerlink" title="chown命令：修改属主或属组"></a>chown命令：修改属主或属组</h6><blockquote>
<p>chown [OPTION]… [OWNER][:[GROUP]] FILE…<br>chown [OPTION]… –reference=RFILE  FILE…<br>此处也是参照文件修改，只是此处修改的是属主和属组（ 注意：此处不修改权限）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"># ll -d mode/</div><div class="line">drwxr-xrwx 2 root root 18 Mar  8 16:13 mode/</div><div class="line"># chown mageedu.mageedu mode/</div><div class="line"># ll -d mode/</div><div class="line">drwxr-xrwx 2 mageedu mageedu 18 Mar  8 16:13 mode/</div><div class="line"></div><div class="line"># ll fstab </div><div class="line">-rwxr-xr-x 1 root root 595 Mar  8 15:57 fstab</div><div class="line"># chown .mageedu fstab    #此处表示修改属组(属组与属主的分隔符可以用点或者冒号(.或:)</div><div class="line"># ll fstab </div><div class="line">-rwxr-xr-x 1 root mageedu 595 Mar  8 15:57 fstab</div><div class="line"># chown mageedu. fstab    #此处表示修改属主</div><div class="line"># ll</div><div class="line">total 4</div><div class="line">-rwxr-xr-x 1 mageedu mageedu 595 Mar  8 15:57 fstab</div><div class="line">常用选项：</div><div class="line">	    -R, --recursive：递归修改；</div><div class="line">                # 与chmod使用方式相同，此处不在过多介绍</div><div class="line">chgrp命令：修改属组</div><div class="line">    chgrp [OPTION]... GROUP FILE...</div><div class="line">    chgrp [OPTION]... --reference=RFILE FILE...</div><div class="line"># ll fstab </div><div class="line">-rwxr-xr-x 1 mageedu mageedu 595 Mar  8 15:57 fstab</div><div class="line"># chgrp xueba fstab </div><div class="line"># ll fstab</div><div class="line">-rwxr-xr-x 1 mageedu xueba   595 Mar  8 15:57 fstab</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="六、下面介绍几个比较实用的用户与用户组相关的Linux命令"><a href="#六、下面介绍几个比较实用的用户与用户组相关的Linux命令" class="headerlink" title="六、下面介绍几个比较实用的用户与用户组相关的Linux命令"></a>六、下面介绍几个比较实用的用户与用户组相关的Linux命令</h3><h4 id="chsh命令：修改用户的登录shell"><a href="#chsh命令：修改用户的登录shell" class="headerlink" title="chsh命令：修改用户的登录shell"></a>chsh命令：修改用户的登录shell</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">chsh [option] [username]</div><div class="line">-s：指定shell</div><div class="line">-l：查看可用shell列表</div></pre></td></tr></table></figure>
<h4 id="chfn命令：修改用户的详细信息"><a href="#chfn命令：修改用户的详细信息" class="headerlink" title="chfn命令：修改用户的详细信息"></a>chfn命令：修改用户的详细信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">chfn [option] [username]</div><div class="line">-f,--full-name 名字</div><div class="line">-o,--office 办公地址</div><div class="line">-p,--office-phone 办公电话</div></pre></td></tr></table></figure>
<h4 id="finger命令：用户信息查找程序"><a href="#finger命令：用户信息查找程序" class="headerlink" title="finger命令：用户信息查找程序"></a>finger命令：用户信息查找程序</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">finger [-lmsp] [user ...] [user@host ...]</div><div class="line">-s：显示用户的列出该用户的帐号名称，真实姓名，登入终端机，闲置时间，登入时间以及地址和电话；</div></pre></td></tr></table></figure>
<h4 id="pwck：用来验证-etc-passwd和-etc-shadow文件的内容格式完整性"><a href="#pwck：用来验证-etc-passwd和-etc-shadow文件的内容格式完整性" class="headerlink" title="pwck：用来验证/etc/passwd和/etc/shadow文件的内容格式完整性"></a>pwck：用来验证/etc/passwd和/etc/shadow文件的内容格式完整性</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pwck [options] [passwd [ shadow ]]</div><div class="line">-s：以用户id排序文件 /etc/passwd /etc/shadow</div><div class="line">-r：只读方式运行命令</div></pre></td></tr></table></figure>
<h4 id="grpck：用来验证-etc-group-etc-gshadow件的内容格式完整性"><a href="#grpck：用来验证-etc-group-etc-gshadow件的内容格式完整性" class="headerlink" title="grpck：用来验证/etc/group /etc/gshadow件的内容格式完整性"></a>grpck：用来验证/etc/group /etc/gshadow件的内容格式完整性</h4><h4 id="grpck-options-group-shadow"><a href="#grpck-options-group-shadow" class="headerlink" title="grpck [options] [group [ shadow ]]"></a>grpck [options] [group [ shadow ]]</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-s：以组id排序文件 /etc/group /etc/gshadow</div><div class="line">-r：只读方式运行命令</div></pre></td></tr></table></figure>
<blockquote>
<p>作者：Antony WX&amp;QQ：1257465991<br>Q/A：如有问题请慷慨提出</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Linux三剑客之grep]]></title>
      <url>http://yoursite.com/2016/07/28/Linux%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8Bgrep/</url>
      <content type="html"><![CDATA[<h3 id="一、Linux文本处理三剑客"><a href="#一、Linux文本处理三剑客" class="headerlink" title="一、Linux文本处理三剑客"></a>一、Linux文本处理三剑客</h3><blockquote>
<p>Linux上有三种常用的文本处理工具，分别为：grep（egrep、fgrep）、sed、awk。今天主要给大家介绍一下三剑客中的第一剑：grep伐木累。</p>
<h3 id="二、grep是什么？"><a href="#二、grep是什么？" class="headerlink" title="二、grep是什么？"></a>二、grep是什么？</h3><p><code>grep</code> 全称（Globally search a Regular Expression and Print）是一个文本搜索工具，基于“pattern”（这里指的是过滤模式，多指正则表达式）对给定的文本进行搜索。</p>
<p>grep家族：<br>        1.grep：支持使用基本正则表达式；<br>        2.egrep：支持使用扩展正则表达式；<br>        3.fgrep：不支持使用正则表达式；</p>
<pre><code># 虽然正则表达式有强大的引擎，但是在单独过滤字符上面 fgrep要起到很大作用，这个作用在日志文件小的时候可能体现不出来，但是当文件达到几亿行就能体现出fgrep的搜索效率。（对大型web网站一天的日志量到几亿行是很轻松的，甚至更多）
</code></pre></blockquote>
<h3 id="三、grep与egrep的主要参数"><a href="#三、grep与egrep的主要参数" class="headerlink" title="三、grep与egrep的主要参数"></a>三、grep与egrep的主要参数</h3><p>在介绍正则表达式前，先介绍一下grep的常用参数，这里所有涉及正则表达式meta字符都会在后续中展开！<br>常用选项：<br>–color=auto：对匹配到的文本着色后高亮显示；（默认centos7对grep、egrep、fgrep已经设置参数，此处不做过多例子）</p>
<h4 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">alias cp=&apos;cp -i&apos;</div><div class="line">alias egrep=&apos;egrep --color=auto&apos;</div><div class="line">alias fgrep=&apos;fgrep --color=auto&apos;</div><div class="line">alias grep=&apos;grep --color=auto&apos;</div><div class="line">alias l.=&apos;ls -d .* --color=auto&apos;</div><div class="line">alias ll=&apos;ls -l --color=auto&apos;</div><div class="line">alias ls=&apos;ls --color=auto&apos;</div><div class="line">alias mv=&apos;mv -i&apos;</div><div class="line">alias rm=&apos;rm -i&apos;</div><div class="line">alias which=&apos;alias | /usr/bin/which --tty-only --read-alias --show-dot --show-tilde&apos;</div></pre></td></tr></table></figure>
<h4 id="i：忽略字符大小写；"><a href="#i：忽略字符大小写；" class="headerlink" title="-i：忽略字符大小写；"></a>-i：忽略字符大小写；</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># cat test</div><div class="line">Hello World</div><div class="line">How are you?</div><div class="line">Mageedu is very good!</div><div class="line"># grep &quot;^H&quot; test</div><div class="line">Hello World</div><div class="line">How are you?</div><div class="line"># grep &quot;^h&quot; test</div><div class="line"># grep -i &quot;^h&quot; test</div><div class="line">Hello World</div><div class="line">How are you?</div></pre></td></tr></table></figure>
<h4 id="o：仅显示匹配-到的文本自身；"><a href="#o：仅显示匹配-到的文本自身；" class="headerlink" title="-o：仅显示匹配 到的文本自身；"></a>-o：仅显示匹配 到的文本自身；</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"># grep &quot;good&quot; test</div><div class="line">Mageedu is very good!</div><div class="line">[root@localhost ~]# grep -o &quot;good&quot; test</div><div class="line">good</div><div class="line">-v，反向匹配；</div><div class="line"># cat test</div><div class="line">Hello World</div><div class="line">How are you?</div><div class="line">Mageedu is very good!</div><div class="line">[root@localhost ~]# grep  &quot;M.*[[:punct:]]$&quot; test</div><div class="line">Mageedu is very good!</div><div class="line">[root@localhost ~]# grep -v &quot;M.*[[:punct:]]$&quot; test</div><div class="line">Hello World</div><div class="line">How are you?</div></pre></td></tr></table></figure>
<h4 id="q-静默模式，不输出任何信息；（省得把输出放到-dev-null，节省系统资源）"><a href="#q-静默模式，不输出任何信息；（省得把输出放到-dev-null，节省系统资源）" class="headerlink" title="-q, 静默模式，不输出任何信息；（省得把输出放到/dev/null，节省系统资源）"></a>-q, 静默模式，不输出任何信息；（省得把输出放到/dev/null，节省系统资源）</h4><p>此处只是为了得到一个返回状态<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># grep -q &quot;good&quot; test</div><div class="line"># echo $?</div><div class="line">0</div><div class="line"># grep -q &quot;goodddddddd&quot; test</div><div class="line"># echo $?</div><div class="line">1</div></pre></td></tr></table></figure></p>
<h4 id="P-支持使用pcre正则表达式（per语言）；"><a href="#P-支持使用pcre正则表达式（per语言）；" class="headerlink" title="-P, 支持使用pcre正则表达式（per语言）；"></a>-P, 支持使用pcre正则表达式（per语言）；</h4><h4 id="e-PATTERN可以同时匹配多个模式"><a href="#e-PATTERN可以同时匹配多个模式" class="headerlink" title="-e PATTERN可以同时匹配多个模式"></a>-e PATTERN可以同时匹配多个模式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># cat test</div><div class="line">Hello World</div><div class="line">How are you?</div><div class="line">Mageedu is very good!</div><div class="line">[root@localhost ~]# grep -e &quot;good&quot; -e &quot;you&quot; test</div><div class="line">How are you?</div><div class="line">Mageedu is very good!</div></pre></td></tr></table></figure>
<h4 id="f-FILEFILE为每行包含了一个pattern的文本文件，即grep-script；（读取文件中的每一行pattern来对指定FILE进行过滤）"><a href="#f-FILEFILE为每行包含了一个pattern的文本文件，即grep-script；（读取文件中的每一行pattern来对指定FILE进行过滤）" class="headerlink" title="-f FILEFILE为每行包含了一个pattern的文本文件，即grep script；（读取文件中的每一行pattern来对指定FILE进行过滤）"></a>-f FILEFILE为每行包含了一个pattern的文本文件，即grep script；（读取文件中的每一行pattern来对指定FILE进行过滤）</h4><p>-f与-e类似，都是匹配多个模式，只是-f选项读取的是文本文件中的模式，逐行匹配。</p>
<h4 id="A-NUM-显示匹配出的后-行"><a href="#A-NUM-显示匹配出的后-行" class="headerlink" title="-A NUM 显示匹配出的后#行"></a>-A NUM 显示匹配出的后#行</h4><h4 id="B-NUM-显示匹配出的前-行"><a href="#B-NUM-显示匹配出的前-行" class="headerlink" title="-B NUM 显示匹配出的前#行"></a>-B NUM 显示匹配出的前#行</h4><h4 id="C-NUM显示匹配出的前后-行"><a href="#C-NUM显示匹配出的前后-行" class="headerlink" title="-C NUM显示匹配出的前后#行"></a>-C NUM显示匹配出的前后#行</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"># cat test</div><div class="line">Hello World</div><div class="line">How are you?</div><div class="line">Mageedu is very good!</div><div class="line"># grep -A 1 &quot;you&quot; test</div><div class="line">How are you?</div><div class="line">Mageedu is very good!</div><div class="line"># grep -B 1 &quot;you&quot; test</div><div class="line">Hello World</div><div class="line">How are you?</div><div class="line"># grep -C 1 &quot;you&quot; test</div><div class="line">Hello World</div><div class="line">How are you?</div><div class="line">Mageedu is very good!</div></pre></td></tr></table></figure>
<h4 id="其他参数"><a href="#其他参数" class="headerlink" title="其他参数"></a>其他参数</h4><p>下面参数针对grep命令而言：<br>-E：支持扩展的正则表达式相当与egrep；<br>-F, –fixed-strings：支持使用固定字符串，不支持正则表达式，相当于fgrep；</p>
<h3 id="四、grep使用及正则表达式"><a href="#四、grep使用及正则表达式" class="headerlink" title="四、grep使用及正则表达式"></a>四、grep使用及正则表达式</h3><h4 id="1-正则表达式的组成"><a href="#1-正则表达式的组成" class="headerlink" title="1.正则表达式的组成"></a>1.正则表达式的组成</h4><p>a、一般字符：没有特殊意义的字符<br>b、特殊字符（meta字符）：元字符，有在正则表达式中有特殊意义</p>
<h4 id="2-下面讲下正则表达式中常见的meta字符-元字符"><a href="#2-下面讲下正则表达式中常见的meta字符-元字符" class="headerlink" title="2.下面讲下正则表达式中常见的meta字符(元字符)"></a>2.下面讲下正则表达式中常见的meta字符(元字符)</h4><h5 id="a、基本正则表达式meta字符"><a href="#a、基本正则表达式meta字符" class="headerlink" title="a、基本正则表达式meta字符"></a>a、基本正则表达式meta字符</h5><h5 id="（1）字符匹配"><a href="#（1）字符匹配" class="headerlink" title="（1）字符匹配"></a>（1）字符匹配</h5><h6 id="“-”-匹配任意单个字符；"><a href="#“-”-匹配任意单个字符；" class="headerlink" title="“.”:匹配任意单个字符；"></a>“.”:匹配任意单个字符；</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># grep r..t /etc/passwd</div><div class="line">root:x:0:0:root:/root:/bin/bash</div><div class="line">operator:x:11:0:operator:/root:/sbin/nologin</div><div class="line">ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</div></pre></td></tr></table></figure>
<h6 id="匹配方位内的任意单个数字；"><a href="#匹配方位内的任意单个数字；" class="headerlink" title="[ ]:匹配方位内的任意单个数字；"></a>[ ]:匹配方位内的任意单个数字；</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># fdisk -l |grep &quot;[sh]d[a-z]\&gt;&quot;</div><div class="line">Disk /dev/sda: 128.8 GB, 128849018880 bytes, 251658240 sectors</div></pre></td></tr></table></figure>
<h6 id="匹配范围外的任意单个数字：托字符指取反之意-下面会讲到"><a href="#匹配范围外的任意单个数字：托字符指取反之意-下面会讲到" class="headerlink" title="[^]匹配范围外的任意单个数字：托字符指取反之意,下面会讲到"></a>[^]匹配范围外的任意单个数字：托字符指取反之意,下面会讲到</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># cat test</div><div class="line">Hello World</div><div class="line">how are you?</div><div class="line">Mageedu is very good!</div></pre></td></tr></table></figure>
<h6 id="upper-：所有大写字母"><a href="#upper-：所有大写字母" class="headerlink" title="[[:upper:]]：所有大写字母"></a>[[:upper:]]：所有大写字母</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># grep &quot;^[^[:upper:]]&quot; test</div><div class="line">how are you?</div></pre></td></tr></table></figure>
<h6 id="其他表示数字的元字符"><a href="#其他表示数字的元字符" class="headerlink" title="其他表示数字的元字符"></a>其他表示数字的元字符</h6><p>[[:upper:]]：所有大写字母；<br>[[:lower:]]：所有小写字母；<br>[[:digit:]]：所有的数字；<br>[[:alpha:]]：所有字母；<br>[[:alnum:]]：所有字母和数字；<br>[[:space:]]：空白字符；<br>[[:punct:]]：标点符号；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># cat test</div><div class="line">Hello World</div><div class="line">how are you?</div><div class="line">Mageedu is very good!</div><div class="line"># grep &quot;[[:upper:]][[:lower:]].*[[:space:]]&quot; test</div><div class="line">Hello World</div><div class="line">Mageedu is very good!</div></pre></td></tr></table></figure></p>
<h6 id="（2）匹配次数"><a href="#（2）匹配次数" class="headerlink" title="（2）匹配次数"></a>（2）匹配次数</h6><p>主要用于限制字符要出现的次数，一般放在出现的次数的字符后面。</p>
<h6 id="：匹配前面的字符任意次（0-1或多次）；"><a href="#：匹配前面的字符任意次（0-1或多次）；" class="headerlink" title="*：匹配前面的字符任意次（0,1或多次）；"></a><code>*</code>：匹配前面的字符任意次（0,1或多次）；</h6><p>此处*表示前面的字符可以出现也可以不出现，所以将文件中所有的行都匹配出来了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># grep &quot;a*&quot; test1</div><div class="line">ab</div><div class="line">aaaabcd</div><div class="line">bcd</div><div class="line">cd</div><div class="line">axxxxxxxd</div></pre></td></tr></table></figure></p>
<h6 id="：任意长度的任意字符（-为匹配单个字符，-为任意次）"><a href="#：任意长度的任意字符（-为匹配单个字符，-为任意次）" class="headerlink" title=".*：任意长度的任意字符（.为匹配单个字符，*为任意次）"></a><code>.*</code>：任意长度的任意字符（.为匹配单个字符，*为任意次）</h6><p>此处.表示匹配任意单个字符，所以在过滤时，文件中的a必须出现至少一次<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># grep &quot;a.*&quot; test1</div><div class="line">ab</div><div class="line">aaaabcd</div><div class="line">axxxxxxxd</div><div class="line">cccabbbd</div></pre></td></tr></table></figure></p>
<h6 id="：匹配前面的字符至少1次；"><a href="#：匹配前面的字符至少1次；" class="headerlink" title="\+：匹配前面的字符至少1次；"></a><code>\+</code>：匹配前面的字符至少1次；</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># grep &quot;a\+&quot; test1</div><div class="line">ab</div><div class="line">aaaabcd</div><div class="line">axxxxxxxd</div><div class="line">cccabbbd</div></pre></td></tr></table></figure>
<h6 id="：匹配前面的0次或1次，即前面的字符可有可无；"><a href="#：匹配前面的0次或1次，即前面的字符可有可无；" class="headerlink" title="\?：匹配前面的0次或1次，即前面的字符可有可无；"></a>\?：匹配前面的0次或1次，即前面的字符可有可无；</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># grep &quot;a\?&quot; test1</div><div class="line">ab</div><div class="line">aaaabcd</div><div class="line">bcd</div><div class="line">cd</div><div class="line">axxxxxxxd</div><div class="line">cccabbbd</div></pre></td></tr></table></figure>
<h6 id="m-：固定匹配前面的字符出现m次，m为非负数；"><a href="#m-：固定匹配前面的字符出现m次，m为非负数；" class="headerlink" title="{\m}：固定匹配前面的字符出现m次，m为非负数；"></a>{\m}：固定匹配前面的字符出现m次，m为非负数；</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># grep &quot;a\&#123;2\&#125;&quot; test1</div><div class="line">aaaabcd</div><div class="line">aaxxxxxxxd</div><div class="line">cccaabbbd</div></pre></td></tr></table></figure>
<h6 id="m-n-至少出现m次，至多出现n次；"><a href="#m-n-至少出现m次，至多出现n次；" class="headerlink" title="{m,n}:至少出现m次，至多出现n次；"></a>{m,n}:至少出现m次，至多出现n次；</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># grep &quot;a\&#123;1,3\&#125;&quot; test1</div><div class="line">ab</div><div class="line">aaaabcd</div><div class="line">aaxxxxxxxd</div><div class="line">cccaabbbd</div><div class="line">    \&#123;0,n\&#125;:至多n次；</div><div class="line">    \&#123;m,\&#125;：至少m次；</div></pre></td></tr></table></figure>
<h5 id="（3）位置锚定"><a href="#（3）位置锚定" class="headerlink" title="（3）位置锚定"></a>（3）位置锚定</h5><p>限制使用模式搜索文本，限制模式所匹配到的文本只能出现于目标文本的哪个位置；</p>
<p><code>^</code>：行首锚定；用于模式的最左侧，^PATTERN<br><code>$</code>：行尾锚定；用于模式的最右侧，PATTERN$<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># ps -ef|grep &quot;^root.*bash$&quot;</div><div class="line">root       1143   1141  0 09:20 pts/0    00:00:00 -bash</div><div class="line">^PATTERN$：要让PATTERN完全匹配一整行；</div><div class="line"># grep &quot;^hello&quot; /tmp/fstab</div><div class="line">hello</div><div class="line">hello world</div><div class="line"># grep &quot;^hello$&quot; /tmp/fstab</div><div class="line">hello</div></pre></td></tr></table></figure></p>
<h6 id="：空行；"><a href="#：空行；" class="headerlink" title="^$：空行；"></a>^$：空行；</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">常用语在文档中过滤多余的空行，-v指取反之意</div><div class="line"># cat test</div><div class="line">Hello World</div><div class="line"></div><div class="line">how are you?</div><div class="line"></div><div class="line">Mageedu is very good!</div><div class="line"></div><div class="line"># grep -v &quot;^$&quot; test</div><div class="line">Hello World</div><div class="line">how are you?</div><div class="line">Mageedu is very good!</div></pre></td></tr></table></figure>
<h6 id="space-：用来在-匹配不到的时候使用；"><a href="#space-：用来在-匹配不到的时候使用；" class="headerlink" title="^[[:space:]]*$：用来在^$匹配不到的时候使用；"></a>^[[:space:]]*$：用来在^$匹配不到的时候使用；</h6><p>此处指有的时候空行中包含空白字符，比如空格、制表符等，用^$就过滤不出来了，此处可以使用此命令过滤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"># grep -v &quot;^$&quot; test</div><div class="line">Hello World</div><div class="line">  </div><div class="line">      </div><div class="line">how are you?</div><div class="line">       </div><div class="line">       </div><div class="line">Mageedu is very good!</div><div class="line"># grep -v &quot;^[[:space:]]*$&quot; test</div><div class="line">Hello World</div><div class="line">how are you?</div><div class="line">Mageedu is very good!</div></pre></td></tr></table></figure></p>
<h6 id="lt-或-b：词首锚定，用于单词模式的左侧，格式为-lt-PATTERN-bPATTERN"><a href="#lt-或-b：词首锚定，用于单词模式的左侧，格式为-lt-PATTERN-bPATTERN" class="headerlink" title="\&lt;或\b：词首锚定，用于单词模式的左侧，格式为\&lt;PATTERN, \bPATTERN"></a>\&lt;或\b：词首锚定，用于单词模式的左侧，格式为\&lt;PATTERN, \bPATTERN</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># fdisk -l|grep &quot;/dev/[sh]d[a-z]&quot;</div><div class="line">Disk /dev/sda: 128.8 GB, 128849018880 bytes, 251658240 sectors</div><div class="line">/dev/sda1   *        2048     1026047      512000   83  Linux</div><div class="line">/dev/sda2         1026048    84912127    41943040   83  Linux</div><div class="line">/dev/sda3        84912128   126855167    20971520   83  Linux</div><div class="line">/dev/sda4       126855168   251658239    62401536    5  Extended</div><div class="line">/dev/sda5       126859264   131055615     2098176   82  Linux swap / Solaris</div><div class="line"># fdisk -l|grep &quot;/dev/[sh]d[a-z]\&gt;&quot;</div><div class="line">Disk /dev/sda: 128.8 GB, 128849018880 bytes, 251658240 sectors</div></pre></td></tr></table></figure>
<h6 id="或-b：词尾锚定，用于单词模式的右侧，格式为PATTERN-PATTERN-b"><a href="#或-b：词尾锚定，用于单词模式的右侧，格式为PATTERN-PATTERN-b" class="headerlink" title=">或\b：词尾锚定，用于单词模式的右侧，格式为PATTERN>, PATTERN\b"></a>>或\b：词尾锚定，用于单词模式的右侧，格式为PATTERN>, PATTERN\b</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># grep &quot;\&lt;root&quot; /etc/passwd</div><div class="line">root:x:0:0:root:/root:/bin/bash</div><div class="line">operator:x:11:0:operator:/root:/sbin/nologin</div></pre></td></tr></table></figure>
<h6 id="：单词锚定"><a href="#：单词锚定" class="headerlink" title="\：单词锚定"></a>\<pattern\>：单词锚定</pattern\></h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">单词：由非特殊字符组成的连续字符（字符串）都称为单词；</div><div class="line"># cat /tmp/ifconfig.test </div><div class="line">/usr/sbin/ifconfig</div><div class="line">/usr/sbin/ifconfig2</div><div class="line">/usr/sbin/ifconfig3</div><div class="line"># grep &quot;ifconfig&quot; /tmp/ifconfig.test </div><div class="line">/usr/sbin/ifconfig</div><div class="line">/usr/sbin/ifconfig2</div><div class="line">/usr/sbin/ifconfig3</div><div class="line"># grep &quot;\&lt;ifconfig\&gt;&quot; /tmp/ifconfig.test </div><div class="line">/usr/sbin/ifconfig</div></pre></td></tr></table></figure>
<h5 id="（4）分组与引用"><a href="#（4）分组与引用" class="headerlink" title="（4）分组与引用"></a>（4）分组与引用</h5><p>(PATTERN):将次PATTERN匹配到的字符当做一个整体处理；分组括号中的模式匹配到的字符会被正则表达式引擎自动纪录于变量中，这些变量分别是\1，\2，\3<br>    \1：第一组括号中的pattern匹配到的字符串；<br>    \2：第二组括号中的pattern匹配到的字符串；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># grep &quot;^\([[:alnum:]]\+\)\&gt;.*\1$&quot; /etc/passwd</div><div class="line">sync:x:5:0:sync:/sbin:/bin/sync</div><div class="line">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</div><div class="line">halt:x:7:0:halt:/sbin:/sbin/halt</div><div class="line">nologin:x:5010:5010::/home/nologin:/sbin/nologin</div></pre></td></tr></table></figure></p>
<h5 id="b、扩展正则表达式meta字符"><a href="#b、扩展正则表达式meta字符" class="headerlink" title="b、扩展正则表达式meta字符"></a>b、扩展正则表达式meta字符</h5><p>注意：与基本正则表达式不同，扩展表达式在一些参数上可以不使用转意符（\），但是在使用上没有什么区别，这里我举几个例子，其他基本与基本正则表达式使用相同！      </p>
<h5 id="此处表示过滤1-255的所有整数"><a href="#此处表示过滤1-255的所有整数" class="headerlink" title="此处表示过滤1-255的所有整数"></a>此处表示过滤1-255的所有整数</h5><p><img src="http://zantony.top/uploads/grep.png" alt="enter image description here"></p>
<h5 id="此处表示取出绝对路径中的基名"><a href="#此处表示取出绝对路径中的基名" class="headerlink" title="此处表示取出绝对路径中的基名"></a>此处表示取出绝对路径中的基名</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># echo `which pwd`|egrep &quot;[^/]+/?$&quot; </div><div class="line">/usr/bin/pwd</div><div class="line"># echo `which pwd`|egrep &quot;[^/]+/?$&quot; -o</div><div class="line">pwd</div></pre></td></tr></table></figure>
<h5 id="此处表示查看root、mageedu、centos用户的详细信息"><a href="#此处表示查看root、mageedu、centos用户的详细信息" class="headerlink" title="此处表示查看root、mageedu、centos用户的详细信息"></a>此处表示查看root、mageedu、centos用户的详细信息</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># egrep &quot;^(root|mageedu|centos)\&gt;&quot; /etc/passwd</div><div class="line">root:x:0:0:root:/root:/bin/bash</div><div class="line">mageedu:x:1000:1000:mageedu:/home/mageedu:/bin/bash</div><div class="line">centos:x:5008:5008::/home/centos:/bin/bash</div></pre></td></tr></table></figure>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>（1）字符匹配<br>.:匹配任意单个字符；<br><code>[ ]</code>:匹配方位内的任意单个数字；<br><code>[^]</code>匹配范围外的任意单个数字；<br><code>[[:upper:]]</code>：所有大写字母；<br><code>[[:lower:]]</code>：所有小写字母；<br><code>[[:digit:]]</code>：所有的数字；<br><code>[[:alpha:]]</code>：所有字母；<br><code>[[:alnum:]]</code>：所有字母和数字；<br><code>[[:space:]]</code>：空白字符；<br><code>[[:punct:]]</code>：标点符号；<br>（2）匹配次数<br>主要用于限制字符要出现的次数，一般放在出现的次数的字符后面。<br><code>*</code>：匹配前面的字符任意次（0,1或多次）；<br><code>.*</code>：任意长度的任意字符（.为匹配单个字符，<em>为任意次）<br><code>+</code>：匹配前面的字符至少1次；<br><code>?</code>：匹配前面的0次或1次，即前面的字符可有可无；<br><code>{m}</code>：固定匹配前面的字符出现m次，m为非负数；<br><code>{m,n}</code>:至少出现m次，至多出现n次；<br><code>{0,n}</code>:至多n次；<br><code>{m,}</code>：至少m次；<br>（3）位置锚定<br>扩展正则表达式中：单词锚定符（\&lt;,>）不能去除转意符()<br><code>^</code>：行首锚定；用于模式的最左侧，^PATTERN<br><code>$</code>：行尾锚定；用于模式的最右侧，PATTERN$<br><code>^PATTERN$</code>：要让PATTERN完全匹配一整行；<br><code>^$</code>：空行；<br>`^[[:space:]]</em>$<code>: 用来在^$匹配不到的时候使用；</code>\&lt;或\b<code>：词首锚定，用于单词模式的左侧，格式为\&lt;PATTERN, \bPATTERN</code>>或\b<code>：词尾锚定，用于单词模式的右侧，格式为PATTERN\&gt;, PATTERN\b</code>\<pattern\><code>：单词锚定
单词：由非特殊字符组成的连续字符（字符串）都称为单词；
（4）分组与引用
(PATTERN):将次PATTERN匹配到的字符当做一个整体处理；分组括号中的模式匹配到的字符会被正则表达式引擎自动纪录于变量中，这些变量分别是\1，\2，\3</code>\1<code>：第一组括号中的pattern匹配到的字符串；</code> \2<code>：第二组括号中的pattern匹配到的字符串
这里的\1 \2不能省略转意符；
（5）或者</code> a|b<code>：a或者b</code>C|cat<code>：表示C或cat</code>(C|c)at`：表示Cat或cat<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># fdisk -l|grep -E &quot;/dev/(s|h)d[a-z]\&gt;&quot;</div><div class="line">Disk /dev/sda: 128.8 GB, 128849018880 bytes, 251658240 sectors</div></pre></td></tr></table></figure></pattern\></p>
<blockquote>
<p>作者：Antony WX&amp;QQ：1257465991<br>Q/A：如有问题请慷慨提出</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[马不羁-oneday]]></title>
      <url>http://yoursite.com/2016/07/28/%E8%80%81%E9%A9%AC%E6%97%A5%E8%AE%B0-oneday/</url>
      <content type="html"><![CDATA[<h1 id="马不羁日记"><a href="#马不羁日记" class="headerlink" title="马不羁日记"></a>马不羁日记</h1><blockquote>
<p>大家好我是老马，今天开始我在这里写日记了，希望大家多多捧场，并且谢谢博主的支持！<br><code>QQ：1457220562</code></p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Nginx+PHP编译安装]]></title>
      <url>http://yoursite.com/2016/07/28/Nginx-PHP%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/</url>
      <content type="html"><![CDATA[<h3 id="编译安装Nginx-amp-PHP"><a href="#编译安装Nginx-amp-PHP" class="headerlink" title="编译安装Nginx&amp;PHP"></a>编译安装Nginx&amp;PHP</h3><h4 id="nginx编译安装"><a href="#nginx编译安装" class="headerlink" title="nginx编译安装"></a><strong>nginx编译安装</strong></h4><p><strong>下载路径</strong>：(建议使用<code>Tengine</code>)<br><a href="http://nginx.org/" target="_blank" rel="external">http://nginx.org/</a><br><a href="http://tengine.taobao.org/" target="_blank" rel="external">http://tengine.taobao.org/</a></p>
<p><strong>启动命令</strong> /usr/local/nginx/sbin/nginx<br><strong>重载nginx</strong> /usr/local/nginx/sbin/nginx -s reload</p>
<h5 id="一、安装环境"><a href="#一、安装环境" class="headerlink" title="一、安装环境"></a>一、安装环境</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">sudo yum groupinstall &quot;Development Tools&quot; -y</div><div class="line">sudo yum install jemalloc-devel openssl-devel pcre-devel -y</div><div class="line"></div><div class="line">nginx编译参数(红色部分可能不支持,可去掉)</div><div class="line"># sudo ./configure --prefix=/usr/local/nginx --user=webapps --group=webapps --with-http_stub_status_module --with-http_ssl_module --with-http_gzip_static_module --with-pcre --with-jemalloc</div><div class="line"># sudo make</div><div class="line"># sudo make install</div><div class="line"># cd /usr/local/nginx</div><div class="line"># sudo mv logs /export/</div><div class="line"># sudo ln -s /export/logs logs</div><div class="line"># cd /usr/local/nginx/conf</div><div class="line"># sudo mkdir vhosts</div></pre></td></tr></table></figure>
<h4 id="二、修改conf文件"><a href="#二、修改conf文件" class="headerlink" title="二、修改conf文件"></a>二、修改conf文件</h4><p><strong>1. 修改主nginx.conf</strong><br>1-1. 开启log_format<br>1-2. 在http上下文结尾增加 include vhosts/*;<br>1-3. 需要注意nginx配置文件是按顺序读取<br>1-5.修改nginx worker用户为webapps<br>1-6.修改/etc/security/limits.conf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"># vim /usr/local/nginx/conf/nginx.conf</div><div class="line">user  webapps;</div><div class="line">worker_processes  2;</div><div class="line">#error_log  logs/error.log;</div><div class="line">#error_log  logs/error.log  notice;</div><div class="line">#error_log  logs/error.log  info;</div><div class="line">#pid        logs/nginx.pid;</div><div class="line">worker_rlimit_nofile 655350;</div><div class="line">events &#123;</div><div class="line">    use epoll;</div><div class="line">    worker_connections  1024;</div><div class="line">&#125;</div><div class="line"># load modules compiled as Dynamic Shared Object (DSO)</div><div class="line">#</div><div class="line">#dso &#123;</div><div class="line">#    load ngx_http_fastcgi_module.so;</div><div class="line">#    load ngx_http_rewrite_module.so;</div><div class="line">#&#125;</div><div class="line">http &#123;</div><div class="line">    include       mime.types;</div><div class="line">    default_type  application/octet-stream;</div><div class="line">    sendfile        on;</div><div class="line">    keepalive_timeout  65;</div><div class="line">    server &#123;</div><div class="line">        listen       80;</div><div class="line">        server_name  localhost;</div><div class="line">        error_page   500 502 503 504  /50x.html;</div><div class="line">        location = /50x.html &#123;</div><div class="line">            root   html;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">include vhosts/*;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>2. 修改自定义配置文件</strong></p>
<h5 id="修改配置文件-usr-local-nginx-conf-vhosts-host-conf"><a href="#修改配置文件-usr-local-nginx-conf-vhosts-host-conf" class="headerlink" title="修改配置文件/usr/local/nginx/conf/vhosts/host.conf"></a><strong>修改配置文件<code>/usr/local/nginx/conf/vhosts/host.conf</code></strong></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">        listen       80;</div><div class="line">        server_name  www.fraudect.com;</div><div class="line">        #charset koi8-r;</div><div class="line">	access_log  logs/www.fraudect.com.access.log;</div><div class="line">        error_log       logs/www.fraudect.com.error.log;</div><div class="line">	location / &#123;</div><div class="line">            root        /export/webapps/www.fraudect.com;</div><div class="line">	    index	index.php;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	location ~ .*\.(html|htm|gif|jpg|jpeg|bmp|png|ico|txt|js|css)$ &#123; </div><div class="line">            	root        /export/webapps/www.fraudect.com;</div><div class="line">    		expires      3d; </div><div class="line">    	&#125; </div><div class="line">	location ~ \.php$ &#123;</div><div class="line">                fastcgi_pass     127.0.0.1:9000;</div><div class="line">                fastcgi_index    index.php;</div><div class="line">		fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</div><div class="line">                include          fastcgi_params;</div><div class="line">                fastcgi_connect_timeout    300;</div><div class="line">                fastcgi_send_timeout       300;</div><div class="line">                fastcgi_read_timeout       300;</div><div class="line">		fastcgi_buffers 8 256k;                                               </div><div class="line">      		fastcgi_buffer_size 256k;                                             </div><div class="line">      		fastcgi_busy_buffers_size 256k; </div><div class="line">		fastcgi_intercept_errors on;</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="若跳转php用此部分"><a href="#若跳转php用此部分" class="headerlink" title="若跳转php用此部分"></a><strong>若跳转<code>php</code>用此部分</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">location ~ \.php$ &#123;</div><div class="line">               fastcgi_pass     127.0.0.1:9000;</div><div class="line">               fastcgi_index    index.php;</div><div class="line">			fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</div><div class="line">               include          fastcgi_params;</div><div class="line">               fastcgi_connect_timeout    300;</div><div class="line">               fastcgi_send_timeout       300;</div><div class="line">               fastcgi_read_timeout       300;</div><div class="line">			fastcgi_buffers 8 256k;                                               </div><div class="line">      		fastcgi_buffer_size 256k;                                             </div><div class="line">      		fastcgi_busy_buffers_size 256k; </div><div class="line">			fastcgi_intercept_errors on;</div><div class="line">       &#125;</div></pre></td></tr></table></figure>
<h4 id="若跳转java走此部分"><a href="#若跳转java走此部分" class="headerlink" title="若跳转java走此部分"></a><strong>若跳转<code>java</code>走此部分</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">location / &#123;</div><div class="line">	proxy_pass http://10.100.10.20:8080;</div><div class="line"></div><div class="line">#	proxy_pass http://axis.prd.pzoom.com;</div><div class="line"></div><div class="line">	proxy_max_temp_file_size 0;</div><div class="line">	proxy_set_header   Host             $host;        </div><div class="line">	proxy_set_header   X-Real-IP        $remote_addr;</div><div class="line">    proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</div><div class="line">    proxy_buffers 256 4k;</div><div class="line">    proxy_connect_timeout 600;</div><div class="line">    proxy_read_timeout 600;</div><div class="line">    proxy_cache_valid 200 302 10m;</div><div class="line">    proxy_cache_valid 301 1h;</div><div class="line">    proxy_cache_valid any 1m;</div><div class="line">	proxy_intercept_errors on;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="upstream-conf-文件"><a href="#upstream-conf-文件" class="headerlink" title="upstream.conf 文件"></a><strong><code>upstream.conf</code> 文件</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">upstream fcgi &#123;</div><div class="line">#upstream的负载均衡，weight是权重，可以根据机器配置定义权重。weigth参数表示权值，权值越高被分配到的几率越大。</div><div class="line">server 192.168.80.121:80 weight=3;</div><div class="line">server 192.168.80.122:80 weight=2;</div><div class="line">server 192.168.80.123:80 weight=3;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="usr-local-nginx-conf-fastcgi-params-文件"><a href="#usr-local-nginx-conf-fastcgi-params-文件" class="headerlink" title="/usr/local/nginx/conf/fastcgi_params 文件"></a><strong><code>/usr/local/nginx/conf/fastcgi_params</code> 文件</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">fastcgi_param  GATEWAY_INTERFACE  CGI/1.1;</div><div class="line">fastcgi_param  SERVER_SOFTWARE    nginx;</div><div class="line">fastcgi_param  QUERY_STRING       $query_string;</div><div class="line">fastcgi_param  REQUEST_METHOD     $request_method;</div><div class="line">fastcgi_param  CONTENT_TYPE       $content_type;</div><div class="line">fastcgi_param  CONTENT_LENGTH     $content_length;</div><div class="line">fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;</div><div class="line">fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;</div><div class="line">fastcgi_param  REQUEST_URI        $request_uri;</div><div class="line">fastcgi_param  DOCUMENT_URI       $document_uri;</div><div class="line">fastcgi_param  DOCUMENT_ROOT      $document_root;</div><div class="line">fastcgi_param  SERVER_PROTOCOL    $server_protocol;</div><div class="line">fastcgi_param  REMOTE_ADDR        $remote_addr;</div><div class="line">fastcgi_param  REMOTE_PORT        $remote_port;</div><div class="line">fastcgi_param  SERVER_ADDR        $server_addr;</div><div class="line">fastcgi_param  SERVER_PORT        $server_port;</div><div class="line">fastcgi_param  SERVER_NAME        $server_name;</div></pre></td></tr></table></figure>
<p><strong>补充内容</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">####### 这个是一个thinkphp框架的伪静态规则，请忽略</div><div class="line">if (!-e $request_filename) &#123;</div><div class="line">rewrite  ^(.*)$  /index.php last;</div><div class="line">break;</div></pre></td></tr></table></figure>
<p>###<strong>php构建部分</strong><br><code>centos  6.X</code>  <code>php-fpm方式</code></p>
<h4 id="一、依赖关系安装"><a href="#一、依赖关系安装" class="headerlink" title="一、依赖关系安装"></a><strong>一、依赖关系安装</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># sudo yum install libmcrypt-devel ncurses-devel recode-devel aspell-devel curl-devel readline-devel openldap-devel enchant-devel pcre-devel net-snmp-devel libicu-devel libtool-ltdl-devel libjpeg-devel libpng-devel libxml2-devel bzip2-devel freetype-devel gcc-c++</div><div class="line"># sudo cp -p /usr/lib64/libldap* /usr/lib</div><div class="line"># sudo yum install mysql-devel</div><div class="line"># sudo ln -s /usr/lib64/mysql /usr/lib/mysql</div></pre></td></tr></table></figure>
<p><strong>php编译参数(如果make报ld之类的错误，尝试移除ldap和lntl编译模块)</strong><br><strong>下载链接地址</strong>：<a href="http://docs.php.net/distributions/php-5.6.24.tar.bz2" target="_blank" rel="external">http://docs.php.net/distributions/php-5.6.24.tar.bz2</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># sudo tar xf php-5.6.24.tar.bz2</div><div class="line"># sudo ./configure --prefix=/usr/local/php  --with-config-file-path=/usr/local/php/etc --with-config-file-scan-dir=/usr/local/php/etc/php.d --with-curl --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd --with-openssl --enable-mbstring --with-freetype-dir --with-jpeg-dir --with-png-dir  --with-gd --with-libxml-dir --with-zlib --with-mcrypt --with-bz2 --enable-sysvshm --enable-sysvsem --enable-soap --with-recode --with-snmp --with-readline  --enable-intl --enable-dba --enable-bcmath --with-enchant --with-pspell --enable-xml --enable-sockets  --enable-exif --enable-inline-optimization --enable-fpm</div></pre></td></tr></table></figure></p>
<h4 id="apache专用"><a href="#apache专用" class="headerlink" title="apache专用"></a>apache专用</h4><p><code>--with-apxs2=/usr/sbin/apxs</code></p>
<h4 id="ubuntu"><a href="#ubuntu" class="headerlink" title="ubuntu"></a>ubuntu</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt-get -y install  libpspell-dev build-essential libcurl3-openssl-dev libbz2-dev libenchant-dev libxml2-dev libjpeg-dev libpng-dev libfreetype6-dev libicu-dev libmcrypt-dev libncurses5-dev  librecode-dev libaspell-dev libreadline-dev</div></pre></td></tr></table></figure>
<h5 id="若apache添加参数-–with-apxs2-usr-sbin-apxs-apxs是apache的httpd-devel安装后生成的，yum安装后路径一般是-usr-sbin-apxs，如果是编译安装，一般位于apache的bin目录下"><a href="#若apache添加参数-–with-apxs2-usr-sbin-apxs-apxs是apache的httpd-devel安装后生成的，yum安装后路径一般是-usr-sbin-apxs，如果是编译安装，一般位于apache的bin目录下" class="headerlink" title="若apache添加参数   –with-apxs2=/usr/sbin/apxs  apxs是apache的httpd-devel安装后生成的，yum安装后路径一般是/usr/sbin/apxs，如果是编译安装，一般位于apache的bin目录下"></a>若apache添加参数   –with-apxs2=/usr/sbin/apxs  apxs是apache的httpd-devel安装后生成的，yum安装后路径一般是/usr/sbin/apxs，如果是编译安装，一般位于apache的bin目录下</h5><h4 id="php-fpm启动脚本"><a href="#php-fpm启动脚本" class="headerlink" title="php-fpm启动脚本"></a><strong>php-fpm启动脚本</strong></h4><p><strong><code>php源码包根目录</code></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># sudo cp sapi/fpm/init.d.php-fpm /etc/rc.d/init.d/php-fpm</div><div class="line"># sudo chkconfig --add php-fpm</div><div class="line"># sudo chkconfig php-fpm on</div><div class="line"># sudo chmod u+x /etc/rc.d/init.d/php-fpm</div><div class="line"># sudo cp php.ini-production /usr/local/php/etc/php.ini</div><div class="line"></div><div class="line"># sudo cd /usr/local/php/var</div><div class="line"># sudo rm -rf log</div><div class="line"># sudo ln -s /export/logs log</div></pre></td></tr></table></figure></p>
<h4 id="修改启动脚本"><a href="#修改启动脚本" class="headerlink" title="修改启动脚本"></a><strong>修改启动脚本</strong></h4><p>脚本前几行注释结束后的首行部位加入<code>[ -f /etc/rc.d/init.d/functions ] &amp;&amp; . /etc/rc.d/init.d/functions</code></p>
<p>在start函数的首行加入daemon<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">case $1 in </div><div class="line">    start)</div><div class="line">    	$php_fpm_BIN --daemonize $php_opts</div></pre></td></tr></table></figure></p>
<p><strong>*修改php.ini 这一步骤需要根据开发来决定开启额外模块或者参数</strong></p>
<h4 id="修改php-fpm-ini-gt-相当于apache的配置文件"><a href="#修改php-fpm-ini-gt-相当于apache的配置文件" class="headerlink" title="修改php-fpm.ini    ==&gt;相当于apache的配置文件"></a><strong>修改<code>php-fpm.ini</code>    ==&gt;相当于apache的配置文件</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#vi /usr/local/php/etc/php-fpm.conf</div><div class="line">[global]</div><div class="line">log_level = notice</div><div class="line">daemonize = yes</div><div class="line">events.mechanism = epoll</div><div class="line">rlimit_files = 10240</div><div class="line">emergency_restart_threshold = 60</div><div class="line">emergency_restart_interval = 60s</div><div class="line">[fcgi]</div><div class="line">user = webapps</div><div class="line">group = webapps</div><div class="line">listen = 0.0.0.0:9000</div><div class="line">pm = static</div><div class="line">pm.max_children = 200</div><div class="line">pm.max_requests = 1024</div></pre></td></tr></table></figure>
<blockquote>
<p>作者：Antony WX&amp;QQ：1257465991<br>Q/A：如有问题请慷慨提出</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>http://yoursite.com/2016/07/27/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    </entry>
    
  
  
</search>
